webpackJsonp([1],{235:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s,r,u,c,f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(2),h=a(d),p=n(15),m=a(p),y=n(169),b=a(y),v=n(70),g=function(e){function t(e){o(this,t);var n=l(this,Object.getPrototypeOf(t).call(this,e));return n.state={count:0,ask:"",nextask:"",answer:""},n.toggle=n.toggle.bind(n),n.timerOn=n.timerOn.bind(n),n.timerOff=n.timerOff.bind(n),n.handleSubmit=n.handleSubmit.bind(n),n.handleNextAskChange=n.handleNextAskChange.bind(n),n}return i(t,e),f(t,[{key:"loadajax",value:function(e){c=new XMLHttpRequest,c.open("GET","http://www.paljaat.fi:8000/chat/"+e,!0),c.onload=function(){if(c.status>=200&&c.status<400){var e=JSON.parse(c.responseText);this.setState({answer:e.answer})}}.bind(this),c.onerror=function(){},c.send()}},{key:"timerOff",value:function(){clearInterval(s),s=0,this.setState({count:0})}},{key:"timerOn",value:function(){var e=this;s=setInterval(function(){console.log(e.state.answer),e.setState({count:e.state.count+1})},3500)}},{key:"toggle",value:function(){var e=m["default"].findDOMNode(this.refs.label_typing);"hidden"===e.style.visibility?e.style.visibility="":e.style.visibility="hidden"}},{key:"componentWillReceiveProps",value:function(e){if(console.log("Chat componentWillReceiveProps",e),r=e.data,this.setState({ask:"Hei "+r.Name+"!"}),"on"===e.timerHandler){m["default"].findDOMNode(this.refs.answer).style.display="none",u=b["default"].v4();var t=u+"/"+r.Phone+"/"+encodeURIComponent(this.state.ask);console.log(t),this.loadajax(encodeURIComponent(t)),this.timerOn()}else console.log("STOP timeR"),this.timerOff()}},{key:"componentWillUpdate",value:function(e){console.log("Chat componentWillUpdate"),this.state.count>7?(m["default"].findDOMNode(this.refs.label_typing).style.visibility="hidden",m["default"].findDOMNode(this.refs.answer).style.display="",this.timerOff()):0!==this.state.count&&this.toggle()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"componentWillMount",value:function(){console.log("willmount Chat"),this.setState({nextask:""}),this.setState({ask:""})}},{key:"componentDidMount",value:function(){console.log("didmount Chat"),r=this.props.data,this.setState({ask:"Hei "+r.Name+"!"});var e=m["default"].findDOMNode(this.refs.answer);e.style.display="none"}},{key:"componentWillUnmount",value:function(){console.log("componentWillUnmount Chat",c),c.abort(),this.timerOff()}},{key:"handleSubmit",value:function(e){if(this.state.nextask.length>0){e.preventDefault(),console.log(this.state.nextask),this.state.ask=this.state.nextask.trim(),this.state.nextask="",m["default"].findDOMNode(this.refs.answer).style.display="none",this.timerOn();var t=u+"/"+r.Phone+"/"+encodeURIComponent(this.state.ask);console.log(t),this.loadajax(encodeURIComponent(t))}}},{key:"handleNextAskChange",value:function(e){this.setState({nextask:e.target.value})}},{key:"render",value:function(){var e=this.props.data,t="odotta",n=this.state.answer,a=this.state.ask;return this.state.count>2&&(t="delivered"),this.state.count>5&&(t="seen"),this.state.count>7&&(t="typing"),h["default"].createElement("div",null,h["default"].createElement("p",null,h["default"].createElement("a",{className:"mbigphone",href:"tel:"+e.Phone},h["default"].createElement("span",{className:"glyphicon glyphicon-earphone","aria-hidden":"true"}),e.Phone)),"Chatti: ",e.Name," ",e.Age,"v",h["default"].createElement(v.Badge,{ref:"label_typing",pullRight:!0},t),h["default"].createElement("p",null),h["default"].createElement(v.Alert,null,a),h["default"].createElement("div",{ref:"answer"},h["default"].createElement(v.Alert,{bsStyle:"danger"},n),h["default"].createElement("form",{onSubmit:this.handleSubmit},h["default"].createElement(v.Input,{type:"text",label:"Name",placeholder:"Kysyä jotain!",value:this.state.nextask,onChange:this.handleNextAskChange})),h["default"].createElement(v.Button,{bsStyle:"primary",onClick:this.handleSubmit},"Jatkaa")))}}]),t}(h["default"].Component);e.exports=g},236:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n(2),u=a(r),c=n(70),f=n(73),d=n(15),h=a(d),p=n(235),m=a(p),y=function(e){function t(e){o(this,t);var n=l(this,Object.getPrototypeOf(t).call(this,e));return n.state={data:[],timerHandler:""},n.handleToggleDetailsChat=n.handleToggleDetailsChat.bind(n),n}return i(t,e),s(t,[{key:"loadajax",value:function(e){console.log(location.hostname);var t=location.hostname;"127.0.0.1"==t&&(t="www.test.com");var n=new XMLHttpRequest;n.open("GET","http://"+t+":8000/api/"+e,!0),n.onload=function(){if(n.status>=200&&n.status<400){var e=JSON.parse(n.responseText);this.setState({data:e})}}.bind(this),n.onerror=function(){},n.send()}},{key:"handleToggleDetailsChat",value:function(){var e=h["default"].findDOMNode(this.refs.chat).style.display;"none"===e?(this.setState({timerHandler:"on"}),h["default"].findDOMNode(this.refs.chat).style.display="",h["default"].findDOMNode(this.refs.details).style.display="none"):(this.setState({timerHandler:"off"}),h["default"].findDOMNode(this.refs.chat).style.display="none",h["default"].findDOMNode(this.refs.details).style.display="")}},{key:"handleReturn",value:function(){f.browserHistory.push("/")}},{key:"componentWillMount",value:function(){this.loadajax(this.props.params.id)}},{key:"componentDidMount",value:function(){h["default"].findDOMNode(this.refs.chat).style.display="none"}},{key:"componentWillReceiveProps",value:function(){}},{key:"componentWillUpdate",value:function(e){}},{key:"componentDidUpdate",value:function(e){}},{key:"render",value:function(){var e=this.state.data,t="http://www.paljaat.fi:8000/img/"+e.ImgId+"/"+e.Img_file_name+"/200/250";return u["default"].createElement("div",null,u["default"].createElement("button",{onClick:this.handleReturn,type:"button",className:"close","data-dismiss":"alert","aria-label":"Close"},u["default"].createElement("span",{"aria-hidden":"true",className:"bigclose"},"×")),u["default"].createElement("div",{ref:"details"},u["default"].createElement("a",{className:"mbigphone",href:"tel:"+e.Phone},u["default"].createElement("span",{className:"glyphicon glyphicon-earphone","aria-hidden":"true"})," ",e.Phone),u["default"].createElement(c.Grid,null,u["default"].createElement(c.Image,{src:t,thumbnail:!0}),u["default"].createElement("p",null,e.Name," ",this.state.data.Age,"v ",e.City),u["default"].createElement(c.Button,{onClick:this.handleToggleDetailsChat,bsStyle:"primary",bsSize:"large",active:!0},"Chatti"))),u["default"].createElement("div",{ref:"chat"},u["default"].createElement(m["default"],{data:e,timerHandler:this.state.timerHandler})))}}]),t}(u["default"].Component);e.exports=y}});